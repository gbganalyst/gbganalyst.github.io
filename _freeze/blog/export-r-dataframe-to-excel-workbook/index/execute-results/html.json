{
  "hash": "ce11f3d496b711e0f404ed8046ddfd2a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Export Multiple Data Frames to Different Excel Worksheets in R\"\nsubtitle: \"with openxlsx2::write_xlsx() function\"\ndescription: |\n  In this tutoral you will learn how to export multiple dataframes in R to an Excel workbook, with each Excel worksheet corresponding to a distint dataframe.\ndate: \"08-19-2024\"\ncategories: \n  - R\n  - Excel\nimage: dataframe.png\nformat:\n  html:\n    df_print: paged\n    fig-cap-location: bottom\n    include-before-body: ../../html/margin_image.html\n    include-after-body: ../../html/blog_footer.html\n    code-fold: false\n    code-tools: true\neditor: \n  markdown: \n    wrap: sentence\nresources: \n  - \"dataframe.png\"\n---\n\n::: {.cell}\n\n:::\n\n\n\n# Introduction\n\nThe `openxlsx2` package provides an efficient way to export multiple data frames from R into an Excel workbook, where each worksheet in the workbook corresponds to a specific data frame in R.\n\n# Prerequisites\n\nThis tutorial begins by ensuring that the necessary packages are installed and loaded.\nIf they are not already present in your R environment, the following code will download and install them.\nNote that an internet connection is required for this step.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(install.load)) {\n  install.packages(\"install.load\")\n}\n\ninstall.load::install_load(c(\"openxlsx2\", \"readxl\", \"purrr\"))\n```\n:::\n\n\n\n# Preparing the Data\n\nIn this example, we will export four commonly used datasets: `airquality`, `mtcars`, `iris`, and `diamonds`, each to a different worksheet within the same Excel workbook.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataframe1 <- datasets::airquality\ndataframe1 |> head()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Ozone\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Solar.R\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Wind\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Temp\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Month\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Day\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"41\",\"2\":\"190\",\"3\":\"7.4\",\"4\":\"67\",\"5\":\"5\",\"6\":\"1\",\"_rn_\":\"1\"},{\"1\":\"36\",\"2\":\"118\",\"3\":\"8.0\",\"4\":\"72\",\"5\":\"5\",\"6\":\"2\",\"_rn_\":\"2\"},{\"1\":\"12\",\"2\":\"149\",\"3\":\"12.6\",\"4\":\"74\",\"5\":\"5\",\"6\":\"3\",\"_rn_\":\"3\"},{\"1\":\"18\",\"2\":\"313\",\"3\":\"11.5\",\"4\":\"62\",\"5\":\"5\",\"6\":\"4\",\"_rn_\":\"4\"},{\"1\":\"NA\",\"2\":\"NA\",\"3\":\"14.3\",\"4\":\"56\",\"5\":\"5\",\"6\":\"5\",\"_rn_\":\"5\"},{\"1\":\"28\",\"2\":\"NA\",\"3\":\"14.9\",\"4\":\"66\",\"5\":\"5\",\"6\":\"6\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ndataframe2 <- datasets::mtcars\ndataframe2 |> head()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"mpg\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"cyl\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"disp\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"hp\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"drat\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"wt\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"qsec\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"vs\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"am\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"gear\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"carb\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"21.0\",\"2\":\"6\",\"3\":\"160\",\"4\":\"110\",\"5\":\"3.90\",\"6\":\"2.620\",\"7\":\"16.46\",\"8\":\"0\",\"9\":\"1\",\"10\":\"4\",\"11\":\"4\",\"_rn_\":\"Mazda RX4\"},{\"1\":\"21.0\",\"2\":\"6\",\"3\":\"160\",\"4\":\"110\",\"5\":\"3.90\",\"6\":\"2.875\",\"7\":\"17.02\",\"8\":\"0\",\"9\":\"1\",\"10\":\"4\",\"11\":\"4\",\"_rn_\":\"Mazda RX4 Wag\"},{\"1\":\"22.8\",\"2\":\"4\",\"3\":\"108\",\"4\":\"93\",\"5\":\"3.85\",\"6\":\"2.320\",\"7\":\"18.61\",\"8\":\"1\",\"9\":\"1\",\"10\":\"4\",\"11\":\"1\",\"_rn_\":\"Datsun 710\"},{\"1\":\"21.4\",\"2\":\"6\",\"3\":\"258\",\"4\":\"110\",\"5\":\"3.08\",\"6\":\"3.215\",\"7\":\"19.44\",\"8\":\"1\",\"9\":\"0\",\"10\":\"3\",\"11\":\"1\",\"_rn_\":\"Hornet 4 Drive\"},{\"1\":\"18.7\",\"2\":\"8\",\"3\":\"360\",\"4\":\"175\",\"5\":\"3.15\",\"6\":\"3.440\",\"7\":\"17.02\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"2\",\"_rn_\":\"Hornet Sportabout\"},{\"1\":\"18.1\",\"2\":\"6\",\"3\":\"225\",\"4\":\"105\",\"5\":\"2.76\",\"6\":\"3.460\",\"7\":\"20.22\",\"8\":\"1\",\"9\":\"0\",\"10\":\"3\",\"11\":\"1\",\"_rn_\":\"Valiant\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ndataframe3 <- datasets::iris\ndataframe3 |> head()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Sepal.Length\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Sepal.Width\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Petal.Length\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Petal.Width\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Species\"],\"name\":[5],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"5.1\",\"2\":\"3.5\",\"3\":\"1.4\",\"4\":\"0.2\",\"5\":\"setosa\",\"_rn_\":\"1\"},{\"1\":\"4.9\",\"2\":\"3.0\",\"3\":\"1.4\",\"4\":\"0.2\",\"5\":\"setosa\",\"_rn_\":\"2\"},{\"1\":\"4.7\",\"2\":\"3.2\",\"3\":\"1.3\",\"4\":\"0.2\",\"5\":\"setosa\",\"_rn_\":\"3\"},{\"1\":\"4.6\",\"2\":\"3.1\",\"3\":\"1.5\",\"4\":\"0.2\",\"5\":\"setosa\",\"_rn_\":\"4\"},{\"1\":\"5.0\",\"2\":\"3.6\",\"3\":\"1.4\",\"4\":\"0.2\",\"5\":\"setosa\",\"_rn_\":\"5\"},{\"1\":\"5.4\",\"2\":\"3.9\",\"3\":\"1.7\",\"4\":\"0.4\",\"5\":\"setosa\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ndataframe4 <- ggplot2::diamonds\ndataframe4 |> head()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"carat\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"cut\"],\"name\":[2],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"color\"],\"name\":[3],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"clarity\"],\"name\":[4],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"depth\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"table\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"price\"],\"name\":[7],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"x\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"z\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.23\",\"2\":\"Ideal\",\"3\":\"E\",\"4\":\"SI2\",\"5\":\"61.5\",\"6\":\"55\",\"7\":\"326\",\"8\":\"3.95\",\"9\":\"3.98\",\"10\":\"2.43\"},{\"1\":\"0.21\",\"2\":\"Premium\",\"3\":\"E\",\"4\":\"SI1\",\"5\":\"59.8\",\"6\":\"61\",\"7\":\"326\",\"8\":\"3.89\",\"9\":\"3.84\",\"10\":\"2.31\"},{\"1\":\"0.23\",\"2\":\"Good\",\"3\":\"E\",\"4\":\"VS1\",\"5\":\"56.9\",\"6\":\"65\",\"7\":\"327\",\"8\":\"4.05\",\"9\":\"4.07\",\"10\":\"2.31\"},{\"1\":\"0.29\",\"2\":\"Premium\",\"3\":\"I\",\"4\":\"VS2\",\"5\":\"62.4\",\"6\":\"58\",\"7\":\"334\",\"8\":\"4.20\",\"9\":\"4.23\",\"10\":\"2.63\"},{\"1\":\"0.31\",\"2\":\"Good\",\"3\":\"J\",\"4\":\"SI2\",\"5\":\"63.3\",\"6\":\"58\",\"7\":\"335\",\"8\":\"4.34\",\"9\":\"4.35\",\"10\":\"2.75\"},{\"1\":\"0.24\",\"2\":\"Very Good\",\"3\":\"J\",\"4\":\"VVS2\",\"5\":\"62.8\",\"6\":\"57\",\"7\":\"336\",\"8\":\"3.94\",\"9\":\"3.96\",\"10\":\"2.48\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n# Exporting Data Frames to Excel\n\nNow that we have our data frames prepared, we will assign them to individual worksheets in an Excel workbook.\nThe worksheet names will correspond to the names of the data frames in R.\nFor example:\n\n-   sheet1- airquality\n-   sheet2- mtcars\n-   sheet3- iris\n-   sheet4- diamonds\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_of_datasets <- list(\n  \"airquality\" = dataframe1,\n  \"mtcars\" = dataframe2,\n  \"iris\" = dataframe3,\n  \"diamonds\" = dataframe4\n)\n\nwrite_xlsx(list_of_datasets, \"Excel_workbook.xlsx\")\n```\n:::\n\n\n\nAfter running the code, you will find the Excel_workbook.xlsx file in your working directory.\n\n# Verifying the Export\n\nYou can verify the content of the Excel workbook either by opening it in `Excel` or by using `R`.\nBelow, we'll check the worksheet names and inspect the contents of each worksheet using the `readxl` and `purrr` packages.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexcel_sheets(\"Excel_workbook.xlsx\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> [1] \"airquality\" \"mtcars\"     \"iris\"       \"diamonds\"\n```\n\n\n:::\n:::\n\n\n\nTo explore the content of each worksheet:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npath <- \"Excel_workbook.xlsx\"\n\npath |>\n  excel_sheets() |>\n  set_names() |>\n  map(read_excel, path = path)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> $airquality\n#> # A tibble: 153 × 6\n#>    Ozone Solar.R  Wind  Temp Month   Day\n#>    <dbl>   <dbl> <dbl> <dbl> <dbl> <dbl>\n#>  1    41     190   7.4    67     5     1\n#>  2    36     118   8      72     5     2\n#>  3    12     149  12.6    74     5     3\n#>  4    18     313  11.5    62     5     4\n#>  5    NA      NA  14.3    56     5     5\n#>  6    28      NA  14.9    66     5     6\n#>  7    23     299   8.6    65     5     7\n#>  8    19      99  13.8    59     5     8\n#>  9     8      19  20.1    61     5     9\n#> 10    NA     194   8.6    69     5    10\n#> # ℹ 143 more rows\n#> \n#> $mtcars\n#> # A tibble: 32 × 11\n#>      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb\n#>    <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n#>  1  21       6  160    110  3.9   2.62  16.5     0     1     4     4\n#>  2  21       6  160    110  3.9   2.88  17.0     0     1     4     4\n#>  3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1\n#>  4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1\n#>  5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2\n#>  6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1\n#>  7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4\n#>  8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2\n#>  9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2\n#> 10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4\n#> # ℹ 22 more rows\n#> \n#> $iris\n#> # A tibble: 150 × 5\n#>    Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n#>           <dbl>       <dbl>        <dbl>       <dbl> <chr>  \n#>  1          5.1         3.5          1.4         0.2 setosa \n#>  2          4.9         3            1.4         0.2 setosa \n#>  3          4.7         3.2          1.3         0.2 setosa \n#>  4          4.6         3.1          1.5         0.2 setosa \n#>  5          5           3.6          1.4         0.2 setosa \n#>  6          5.4         3.9          1.7         0.4 setosa \n#>  7          4.6         3.4          1.4         0.3 setosa \n#>  8          5           3.4          1.5         0.2 setosa \n#>  9          4.4         2.9          1.4         0.2 setosa \n#> 10          4.9         3.1          1.5         0.1 setosa \n#> # ℹ 140 more rows\n#> \n#> $diamonds\n#> # A tibble: 53,940 × 10\n#>    carat cut       color clarity depth table price     x     y     z\n#>    <dbl> <chr>     <chr> <chr>   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n#>  1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43\n#>  2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31\n#>  3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31\n#>  4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63\n#>  5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75\n#>  6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48\n#>  7  0.24 Very Good I     VVS1     62.3    57   336  3.95  3.98  2.47\n#>  8  0.26 Very Good H     SI1      61.9    55   337  4.07  4.11  2.53\n#>  9  0.22 Fair      E     VS2      65.1    61   337  3.87  3.78  2.49\n#> 10  0.23 Very Good H     VS1      59.4    61   338  4     4.05  2.39\n#> # ℹ 53,930 more rows\n```\n\n\n:::\n:::\n\n\n\n# Conclusion\n\nThis tutorial demonstrated how to efficiently export multiple data frames to separate worksheets in an Excel workbook using R.\nThe approach is highly customizable, allowing for easy integration into your data analysis workflow.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}